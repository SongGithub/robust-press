#!/usr/bin/env bash

dcr="docker-compose run --rm"

set -e

if [ "$#" -lt 2 ]; then
  echo "Usage: bin/deploy_cfn <component_name> <env> <artifact_version>"
  exit 1
fi

component_name=$1
env=$2
artifact_version=${3:-0}

$dcr kt clean && $dcr kt deploy -t cfn \
  -c "$component_name" \
  -e default -e "$env" \
  -p artifact_version="$artifact_version"